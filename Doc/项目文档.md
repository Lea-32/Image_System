# 图片收藏和管理系统项目文档

## 1. 项目概述
本项目是一个基于Flask框架开发的图片收藏和管理系统，集成了图片上传、展示、收藏、评论、搜索等功能，并使用了深度学习技术进行图片分类和标签生成。

## 2. 技术栈
### 2.1 后端技术
- Web框架：Flask 2.0.1
- 数据库：SQL Server (通过pyodbc连接)
- ORM：SQLAlchemy 1.4.23
- 图片处理：Pillow 9.2.0, OpenCV 4.6.0.66
- 深度学习：PyTorch 1.9.0, torchvision 0.10.0
- 文本处理：jieba 0.42.1, NLTK 3.9
- 安全认证：Flask-Login 0.5.0, Flask-Security 3.0.0

### 2.2 前端技术
- 模板引擎：Jinja2 3.0.1
- 表单处理：Flask-WTF 0.15.1, WTForms 2.3.3
- 样式：CSS
- 交互：JavaScript

## 3. 系统架构
### 3.1 目录结构
```
├── app/                 # 应用主目录
├── routes/             # 路由处理模块
│   ├── login.py        # 登录相关路由
│   ├── main.py         # 主页面路由
│   ├── upload.py       # 图片上传路由
│   ├── show_img.py     # 图片展示路由
│   ├── favorite.py     # 收藏功能路由
│   ├── comment.py      # 评论功能路由
│   ├── search.py       # 搜索功能路由
│   └── delete_img.py   # 图片删除路由
├── static/             # 静态资源
├── templates/          # HTML模板
├── SQL/               # SQL脚本
├── Doc/               # 项目文档
└── app.py             # 应用入口文件
```

### 3.2 核心功能模块
1. 用户认证模块
   - 用户注册
   - 用户登录
   - 会话管理
   - 权限控制

2. 图片管理模块
   - 图片上传
   - 图片展示
   - 图片删除
   - 图片分类
   - 图片标签生成

3. 社交功能模块
   - 图片收藏
   - 评论系统
   - 点赞功能

4. 搜索功能模块
   - 基于标签的搜索
   - 基于内容的搜索

## 4. 数据库设计
系统使用SQL Server数据库，主要包含以下表：
- users: 用户信息表
- images: 图片信息表
- favorites: 收藏关系表
- comments: 评论信息表
- tags: 标签信息表
- image_tags: 图片-标签关联表

## 5. API接口说明
### 5.1 用户相关接口
- POST /register: 用户注册
- POST /login: 用户登录
- GET /logout: 用户登出
- GET /check_login: 检查登录状态

### 5.2 图片相关接口
- POST /upload: 上传图片
- GET /show/<image_id>: 显示图片详情
- POST /delete/<image_id>: 删除图片
- GET /search: 搜索图片

### 5.3 社交功能接口
- POST /favorite/<image_id>: 收藏图片
- POST /like/<image_id>: 点赞图片
- POST /comment/<image_id>: 添加评论

## 6. 部署说明
1. 环境要求
   - Python 3.8+
   - SQL Server
   - CUDA支持（用于深度学习功能）

2. 安装步骤
   ```bash
   # 创建虚拟环境
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows

   # 安装依赖
   pip install -r requirements.txt

   # 配置数据库
   # 修改db_config.py中的数据库连接信息

   # 运行应用
   python app.py
   ```

